{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://G%3A/_dev/hidden_path/arg-game/src/app/admin/bookings/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useToast } from \"~/hooks/use-toast\";\r\nimport { type Game, type Team } from \"@prisma/client\";\r\n\r\ninterface BookingWithRelations {\r\n    id: number;\r\n    teamId: number;\r\n    gameId: number;\r\n    code: string;\r\n    createdAt: Date;\r\n    startTime: Date | null;\r\n    expiresAt: Date | null;\r\n    voucher: string | null;\r\n    paid: boolean;\r\n    notes: string | null;\r\n    team: Pick<Team, \"id\" | \"name\">;\r\n    game: Pick<Game, \"id\" | \"name\">;\r\n    instance: {\r\n        startedAt: Date | null;\r\n        completedAt: Date | null;\r\n        currentPuzzleOrder: number | null;\r\n    } | null;\r\n}\r\n\r\ninterface ApiResponse {\r\n    bookings: BookingWithRelations[];\r\n}\r\n\r\nexport default function BookingsPage() {\r\n    const [bookings, setBookings] = useState<BookingWithRelations[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [deleting, setDeleting] = useState<string | null>(null);\r\n    const { toast } = useToast();\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        async function fetchBookings() {\r\n            try {\r\n                const response = await fetch('/api/bookings');\r\n                if (!response.ok) throw new Error('Failed to fetch bookings');\r\n                const data = await response.json() as ApiResponse;\r\n                setBookings(data.bookings);\r\n            } catch (error) {\r\n                console.error('Error fetching bookings:', error);\r\n                toast({\r\n                    variant: \"destructive\",\r\n                    title: \"Error\",\r\n                    description: \"Failed to load bookings\",\r\n                });\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n\r\n        void fetchBookings();\r\n    }, [toast]);\r\n\r\n    async function handleDelete(code: string) {\r\n        if (!confirm('Are you sure you want to delete this booking?')) {\r\n            return;\r\n        }\r\n\r\n        setDeleting(code);\r\n        try {\r\n            const response = await fetch(`/api/bookings/${code}`, {\r\n                method: 'DELETE',\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Failed to delete booking');\r\n            }\r\n\r\n            setBookings(bookings.filter(b => b.code !== code));\r\n            toast({\r\n                title: \"Success\",\r\n                description: \"Booking deleted successfully\",\r\n            });\r\n        } catch (error) {\r\n            console.error('Error deleting booking:', error);\r\n            toast({\r\n                variant: \"destructive\",\r\n                title: \"Error\",\r\n                description: \"Failed to delete booking\",\r\n            });\r\n        } finally {\r\n            setDeleting(null);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return <div>Loading...</div>;\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"flex justify-between items-center mb-8\">\r\n                <h1 className=\"text-3xl font-bold\">Bookings</h1>\r\n                <Link\r\n                    href=\"/admin/bookings/new\"\r\n                    className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700\"\r\n                >\r\n                    Create New Booking\r\n                </Link>\r\n            </div>\r\n\r\n            <div className=\"rounded-lg border border-slate-800 bg-slate-900/50\">\r\n                <table className=\"min-w-full\">\r\n                    <thead>\r\n                        <tr className=\"border-b border-slate-800\">\r\n                            <th className=\"text-left p-4 text-slate-200\">Code</th>\r\n                            <th className=\"text-left p-4 text-slate-200\">Team</th>\r\n                            <th className=\"text-left p-4 text-slate-200\">Game</th>\r\n                            <th className=\"text-center p-4 text-slate-200\">Status</th>\r\n                            <th className=\"text-center p-4 text-slate-200\">Start Time</th>\r\n                            <th className=\"text-center p-4 text-slate-200\">Expires</th>\r\n                            <th className=\"text-center p-4 text-slate-200\">Paid</th>\r\n                            <th className=\"text-center p-4 text-slate-200\">Voucher</th>\r\n                            <th className=\"text-right p-4 text-slate-200\">Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {bookings.map((booking) => (\r\n                            <tr key={booking.id} className=\"border-b border-slate-800 hover:bg-slate-800/50\">\r\n                                <td className=\"p-4\">\r\n                                    <span className=\"font-mono text-slate-200\">{booking.code}</span>\r\n                                    {booking.notes && (\r\n                                        <div className=\"text-sm text-slate-400 mt-1\">{booking.notes}</div>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4\">\r\n                                    <Link\r\n                                        href={`/admin/teams/${booking.team.id}`}\r\n                                        className=\"text-blue-400 hover:text-blue-300\"\r\n                                    >\r\n                                        {booking.team.name}\r\n                                    </Link>\r\n                                </td>\r\n                                <td className=\"p-4\">\r\n                                    <Link\r\n                                        href={`/admin/games/${booking.game.id}`}\r\n                                        className=\"text-blue-400 hover:text-blue-300\"\r\n                                    >\r\n                                        {booking.game.name}\r\n                                    </Link>\r\n                                </td>\r\n                                <td className=\"p-4 text-center\">\r\n                                    {booking.instance ? (\r\n                                        booking.instance.completedAt ? (\r\n                                            <span className=\"text-green-400\">Completed</span>\r\n                                        ) : (\r\n                                            <span className=\"text-yellow-400\">In Progress</span>\r\n                                        )\r\n                                    ) : (\r\n                                        <span className=\"text-slate-400\">Not Started</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-center text-slate-400\">\r\n                                    {booking.startTime ? (\r\n                                        new Date(booking.startTime).toLocaleString()\r\n                                    ) : (\r\n                                        <span className=\"text-slate-500\">Not Set</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-center text-slate-400\">\r\n                                    {booking.expiresAt ? (\r\n                                        new Date(booking.expiresAt).toLocaleString()\r\n                                    ) : (\r\n                                        <span className=\"text-slate-500\">Never</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-center\">\r\n                                    {booking.paid ? (\r\n                                        <span className=\"text-green-400\">Yes</span>\r\n                                    ) : (\r\n                                        <span className=\"text-red-400\">No</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-center text-slate-400\">\r\n                                    {booking.voucher ?? <span className=\"text-slate-500\">None</span>}\r\n                                </td>\r\n                                <td className=\"p-4 text-right\">\r\n                                    <Link\r\n                                        href={`/admin/bookings/${booking.code}`}\r\n                                        className=\"text-blue-400 hover:text-blue-300 mr-4\"\r\n                                    >\r\n                                        Edit\r\n                                    </Link>\r\n                                    <button\r\n                                        onClick={() => void handleDelete(booking.code)}\r\n                                        disabled={deleting === booking.code}\r\n                                        className=\"text-red-400 hover:text-red-300 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                    >\r\n                                        {deleting === booking.code ? 'Deleting...' : 'Delete'}\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 436, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 446, "column": 0}, "map": {"version":3,"sources":["file://G%3A/_dev/hidden_path/arg-game/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}},
    {"offset": {"line": 447, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}